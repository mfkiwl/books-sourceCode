%
%%%%%%%%%%%%%%%%%%%%%%%%%% Beginning of data input %%%%%%%%%%%%%%%%%%%%%%%%%%% 
%
global nnd nel nne nodof eldof  n ngp
global geom connec dee nf  Nodal_loads

%
nnd = 121 ;                % Number of nodes:  				
nel = 32;                  % Number of elements: 				
nne = 8 ;                % Number of nodes per element:			
nodof =2;                % Number of degrees of freedom per node
ngp = 2                  % number of Gauss points
eldof = nne*nodof;       % Number of degrees of freedom per element 	
%
% Thickness of the domain
thick = 100.
%
%  Nodes coordinates x and y  
%
geom = [ 0       0	; ...        %   x and y coordinates of node 1
        0       50	; ...
        0       100	; ...
        0       150	; ...
        0       200	; ...
        0       250	; ...
        0       300	; ...
        0       350	; ...
        0       400	; ...
        50      0	; ...
        50      100	; ...
        50      200	; ...
        50      300	; ...
        50      400	; ...
        100     0	; ...
        100     50	; ...
        100     100	; ...
        100     150	; ...
        100     200	; ...
        100     250	; ...
        100     300	; ...
        100     350	; ...
        100     400	; ...
        150     0	; ...
        150     100	; ...
        150     200	; ...
        150     300	; ...
        150     400	; ...
        200     0	; ...
        200     50	; ...
        200     100	; ...
        200     150	; ...
        200     200	; ...
        200     250	; ...
        200     300	; ...
        200     350	; ...
        200     400	; ...
        250     0	; ...
        250     100	; ...
        250     200	; ...
        250     300	; ...
        250     400	; ...
        300     0	; ...
        300     50	; ...
        300     100	; ...
        300     150	; ...
        300     200	; ...
        300     250	; ...
        300     300	; ...
        300     350	; ...
        300     400	; ...
        350     0	; ...
        350     100	; ...
        350     200	; ...
        350     300	; ...
        350     400	; ...
        400     0	; ...
        400     50	; ...
        400     100	; ...
        400     150	; ...
        400     200	; ...
        400     250	; ...
        400     300	; ...
        400     350	; ...
        400     400	; ...
        450     0	; ...
        450     100	; ...
        450     200	; ...
        450     300	; ...
        450     400	; ...
        500     0	; ...
        500     50	; ...
        500     100	; ...
        500     150	; ...
        500     200	; ...
        500     250	; ...
        500     300	; ...
        500     350	; ...
        500     400	; ...
        550     0	; ...
        550     100	; ...
        550     200	; ...
        550     300	; ...
        550     400	; ...
        600     0	; ...
        600     50	; ...
        600     100	; ...
        600     150	; ...
        600     200	; ...
        600     250	; ...
        600     300	; ...
        600     350	; ...
        600     400	; ...
        650     0	; ...
        650     100	; ...
        650     200	; ...
        650     300	; ...
        650     400	; ...
        700     0	; ...
        700     50	; ...
        700     100	; ...
        700     150	; ...
        700     200	; ...
        700     250	; ...
        700     300	; ...
        700     350	; ...
        700     400	; ...
        750     0	; ...
        750     100	; ...
        750     200	; ...
        750     300	; ...
        750     400	; ...
        800     0	; ...
        800     50	; ...
        800     100	; ...
        800     150	; ...
        800     200	; ...
        800     250	; ...
        800     300	; ...
        800     350	; ...
        800     400]	;  %   x and y coordinates of node 121
%
% Element connectivity
%

  connec = [1	10	15	16	17	11	3	2	; ...  % Element 1  
            3	11	17	18	19	12	5	4	; ...
            5	12	19	20	21	13	7	6	; ...
            7	13	21	22	23	14	9	8	; ...
            15	24	29	30	31	25	17	16	; ...
            17	25	31	32	33	26	19	18	; ...
            19	26	33	34	35	27	21	20	; ...
            21	27	35	36	37	28	23	22	; ...
            29	38	43	44	45	39	31	30	; ...
            31	39	45	46	47	40	33	32	; ...
            33	40	47	48	49	41	35	34	; ...
            35	41	49	50	51	42	37	36	; ...
            43	52	57	58	59	53	45	44	; ...
            45	53	59	60	61	54	47	46	; ...
            47	54	61	62	63	55	49	48	; ...
            49	55	63	64	65	56	51	50	; ...
            57	66	71	72	73	67	59	58	; ...
            59	67	73	74	75	68	61	60	; ...
            61	68	75	76	77	69	63	62	; ...
            63	69	77	78	79	70	65	64	; ...
            71	80	85	86	87	81	73	72	; ...
            73	81	87	88	89	82	75	74	; ...
            75	82	89	90	91	83	77	76	; ...
            77	83	91	92	93	84	79	78	; ...
            85	94	99	100	101	95	87	86	; ...
            87	95	101	102	103	96	89	88	; ...
            89	96	103	104	105	97	91	90	; ...
            91	97	105	106	107	98	93	92	; ...
            99	108	113	114	115	109	101	100	; ...
            101	109	115	116	117	110	103	102	; ...
            103	110	117	118	119	111	105	104	; ...
            105	111	119	120	121	112	107	106	];      % Element 32
%
% Material properties
%
E=40000; vu=0.17;          % Young's modulus and Poisson's ratio
%
% Form the matrix of elastic properties
%
dee=formdsig(E,vu);       % Matrix of elastic properties for plane stress
%
% Boundary conditions
%
nf = ones(nnd, nodof);                   % Initialise the matrix nf to 1
%
for i=1:nnd
    if geom(i,1) == 800.;
        nf(i,:) = [0 1];
    end
     if geom(i,1) == 100. && geom(i,2) == 0.;
        nf(i,:) = [1 0];
    end
    
end
%          
% Counting of the free degrees of freedom
%
n=0;
for i=1:nnd
    for j=1:nodof
        if nf(i,j) ~= 0 
            n=n+1;
           nf(i,j)=n;
        end
    end
end
disp ('Nodal freedom')
nf
disp ('Total number of active degrees of freedom')
n
%
% loading
%
Nodal_loads = zeros(nnd, 2);
Nodal_loads(79,2)=-30000.;         % Vertical load on node 79      
%
% End input